---
id: E5-A7
epic: "Épico 5 — Chat Conversacional & Experiências Multimodais"
status: backlog
tags:
  - frontend
  - angular
  - chat
  - streaming
  - obsidian/backlog
dependencies:
  - E5-A4
obsidian-link: "[[E5-A7 Suporte a streaming de mensagens]]"
---

# E5-A7 · Suporte a streaming de mensagens

## Descrição técnica
- Implementar `MessageStreamService` em `libs/chat/data-access` com suporte a SSE (`EventSource`) e fallback para polling (`timer + switchMap`).
- Definir contratos para eventos incrementais (`StreamChunk`, `StreamCompleted`, `StreamError`).
- Integrar `ChatStore` para consumir streaming via `setStreamingState` e atualizar mensagens em progresso (`message.partialContent`).
- Ajustar `ConversationViewComponent` para exibir spinner/indicador enquanto tokens chegam e consolidar mensagem ao final.
- Tornar parâmetros configuráveis (timeout, retry) via `environment` e injetor Angular.
- Cobrir fallback com testes unitários e end-to-end simulando SSE ausente.

## Dependências
- `E5-A4` (visão de conversa implementada).

## Critérios de aceite
- Streaming via SSE funcionando quando backend suporta, com reconexão automática.
- Fallback para polling ativado quando SSE indisponível, sem duplicar mensagens.
- Testes validam ambos os cenários e garantem que UI reflita progresso.

## Checklist sugerido
- [ ] Implementar serviço de streaming com SSE/polling.
- [ ] Integrar store para atualizar mensagens em progresso.
- [ ] Ajustar UI para exibir estado de streaming.
- [ ] Configurar opções de timeout/retry.
- [ ] Criar testes cobrindo SSE ativo e fallback.
