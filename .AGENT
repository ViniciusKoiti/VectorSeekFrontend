# VectorSeek Frontend - Guia de ReferÃªncia para Agentes

Este arquivo serve como referÃªncia rÃ¡pida para agentes de IA que trabalham neste projeto.

## ğŸ¯ Contexto do Projeto

**VectorSeek Frontend** Ã© uma aplicaÃ§Ã£o Angular 17+ em monorepo Nx focada em autenticaÃ§Ã£o e fundaÃ§Ã£o de uma plataforma de descoberta de conhecimento baseada em IA.

## ğŸ“ Estrutura de DiretÃ³rios CrÃ­ticos

```
vectorseek-frontend/
â”œâ”€â”€ apps/platform/src/app/
â”‚   â”œâ”€â”€ auth/                    # MÃ³dulo de autenticaÃ§Ã£o
â”‚   â”‚   â”œâ”€â”€ login-page.component.ts
â”‚   â”‚   â”œâ”€â”€ register-page.component.ts
â”‚   â”‚   â”œâ”€â”€ forgot-password.component.ts
â”‚   â”‚   â”œâ”€â”€ auth.routes.ts       # Rotas lazy-loaded
â”‚   â”‚   â”œâ”€â”€ schemas/             # ValidaÃ§Ãµes Zod
â”‚   â”‚   â””â”€â”€ utils/               # UtilitÃ¡rios de autenticaÃ§Ã£o
â”‚   â””â”€â”€ layouts/                 # Layouts da aplicaÃ§Ã£o
â”‚       â”œâ”€â”€ auth-layout.component.ts
â”‚       â””â”€â”€ public-layout.component.ts
â”œâ”€â”€ libs/data-access/src/lib/auth/
â”‚   â”œâ”€â”€ auth.service.ts          # ServiÃ§o principal de autenticaÃ§Ã£o
â”‚   â”œâ”€â”€ auth.models.ts           # Interfaces e tipos TypeScript
â”‚   â””â”€â”€ auth.api.ts              # Endpoints da API
â””â”€â”€ libs/ui/auth/                # Stories do Storybook
```

## ğŸ”‘ Pontos Importantes

### 1. Arquitetura Standalone
- **TODOS** os componentes sÃ£o standalone (sem NgModules)
- Use `standalone: true` em todos os componentes
- Importe dependÃªncias diretamente no componente

### 2. Lazy Loading
- Rotas principais usam `loadComponent()` ou `loadChildren()`
- Nunca importe componentes diretamente em rotas principais
- Use dynamic imports: `() => import(...).then(m => m.Component)`

### 3. ValidaÃ§Ã£o Zod
- Todos os formulÃ¡rios devem usar schemas Zod
- Schemas estÃ£o em `apps/platform/src/app/auth/schemas/`
- Mensagens de validaÃ§Ã£o usam chaves de traduÃ§Ã£o (ex: `'auth.validation.required'`)

### 4. AuthService
- **LocalizaÃ§Ã£o**: `libs/data-access/src/lib/auth/auth.service.ts`
- **MÃ©todos disponÃ­veis**:
  - `login(LoginRequest): Observable<LoginResponse>`
  - `register(RegisterRequest): Observable<RegisterResponse>`
  - `requestMagicLink(RequestMagicLinkRequest): Observable<RequestMagicLinkResponse>`
  - `refresh(RefreshRequest): Observable<RefreshResponse>`
  - `me(): Observable<MeResponse>`
- Todos os mÃ©todos retornam `Observable` e tratam erros automaticamente

### 5. Endpoints da API
- Base path: `/api/auth`
- Endpoints:
  - `POST /api/auth/login`
  - `POST /api/auth/register`
  - `POST /api/auth/magic-link`
  - `POST /api/auth/refresh`
  - `GET /api/auth/me`
- Todos os endpoints retornam `AuthApiEnvelope<T>` com estrutura `{ data: T }`

### 6. Tratamento de Erros
- `AuthService` normaliza erros automaticamente
- Erros retornam `AuthError` com:
  - `status`: cÃ³digo HTTP
  - `code`: cÃ³digo de erro
  - `summary`: mensagem resumida
  - `description`: descriÃ§Ã£o detalhada
  - `fieldErrors`: erros por campo (opcional)
  - `retryAfterSeconds`: rate limiting (opcional)

### 7. InternacionalizaÃ§Ã£o
- Biblioteca: `@ngx-translate/core`
- Idioma padrÃ£o: `pt-BR`
- Arquivos: `apps/platform/src/assets/i18n/auth/`
- Namespace: `auth` para mensagens de autenticaÃ§Ã£o
- Use `TranslateService` para traduÃ§Ãµes

### 8. Rotas
- Rotas principais: `apps/platform/src/app/app.routes.ts`
- Rotas de auth: `apps/platform/src/app/auth/auth.routes.ts`
- Layout padrÃ£o: `/` â†’ `PublicLayoutComponent`
- Layout auth: `/auth/*` â†’ `AuthLayoutComponent`

## ğŸ”§ PadrÃµes de CÃ³digo

### Componente Standalone
```typescript
import { Component } from '@angular/core';
import { CommonModule } from '@angular/common';

@Component({
  selector: 'vectorseek-example',
  standalone: true,
  imports: [CommonModule],
  template: `...`,
  styles: [`...`]
})
export class ExampleComponent {}
```

### Uso do AuthService
```typescript
import { inject } from '@angular/core';
import { AuthService } from '@vectorseek/data-access';
import { catchError } from 'rxjs/operators';

export class MyComponent {
  private authService = inject(AuthService);

  login(email: string, password: string) {
    this.authService.login({ email, password })
      .pipe(
        catchError((error: AuthError) => {
          // Tratar erro
          return throwError(() => error);
        })
      )
      .subscribe(session => {
        // Sucesso
      });
  }
}
```

### Schema Zod
```typescript
import { z } from '@colsen1996/ng-zod-form';
import type { LoginRequest } from '@vectorseek/data-access/lib/auth/auth.models';

export const myFormSchema: z.ZodType<LoginRequest> = z.object({
  email: z.string({ required_error: 'auth.validation.required' })
    .email('auth.validation.email'),
  password: z.string({ required_error: 'auth.validation.required' })
    .min(8, 'auth.validation.passwordLength')
});
```

## ğŸ“¦ DependÃªncias Principais

### Core
- `@angular/core`, `@angular/common`, `@angular/router`
- `@angular/forms`, `@angular/platform-browser`
- `rxjs` (programaÃ§Ã£o reativa)

### ValidaÃ§Ã£o
- `zod` (validaÃ§Ã£o de schemas)
- `@colsen1996/ng-zod-form` (integraÃ§Ã£o Angular + Zod)

### i18n
- `@ngx-translate/core`
- `@ngx-translate/http-loader`

### SSR
- `@nguniversal/express-engine`
- `express`

### Build
- `nx` (monorepo)
- TypeScript strict mode

## ğŸš« O Que NÃƒO Fazer

1. âŒ **NÃƒO** criar NgModules - use componentes standalone
2. âŒ **NÃƒO** importar componentes diretamente em rotas - use lazy loading
3. âŒ **NÃƒO** fazer validaÃ§Ã£o manual - use Zod schemas
4. âŒ **NÃƒO** chamar HTTP diretamente - use AuthService
5. âŒ **NÃƒO** hardcode mensagens - use i18n
6. âŒ **NÃƒO** criar serviÃ§os em `apps/` - use `libs/data-access`
7. âŒ **NÃƒO** misturar lÃ³gica de negÃ³cio em componentes - use serviÃ§os

## âœ… O Que Fazer

1. âœ… Use componentes standalone sempre
2. âœ… Use lazy loading para rotas
3. âœ… Valide com Zod schemas
4. âœ… Use AuthService para todas as chamadas de autenticaÃ§Ã£o
5. âœ… Use chaves de traduÃ§Ã£o para mensagens
6. âœ… Coloque serviÃ§os compartilhados em `libs/data-access`
7. âœ… Mantenha componentes focados em apresentaÃ§Ã£o
8. âœ… Use `inject()` para injeÃ§Ã£o de dependÃªncias
9. âœ… Trate erros com catchError do RxJS
10. âœ… Siga os padrÃµes de nomenclatura (kebab-case para arquivos, PascalCase para classes)

## ğŸ¨ Estilos e Design

- Componentes usam estilos inline (template strings)
- Paleta de cores baseada em Tailwind CSS
- Design responsivo e mobile-first
- EspaÃ§amento consistente com gaps de 1rem, 1.5rem, 2rem

## ğŸ§ª Testes

- Testes em `*.spec.ts`
- Use `HttpClientTestingModule` para testar AuthService
- Cobertura mÃ­nima: 70% para `libs/data-access/auth`
- Execute com: `nx test [project]`

## ğŸ“ Nomenclatura

- **Componentes**: `ComponentNameComponent` (PascalCase)
- **ServiÃ§os**: `ServiceNameService` (PascalCase)
- **Arquivos**: `kebab-case.component.ts`
- **Selectors**: `vectorseek-kebab-case`
- **Interfaces**: `InterfaceName` (PascalCase)
- **Constantes**: `CONSTANT_NAME` (UPPER_SNAKE_CASE)

## ğŸ” Locais Importantes

- **Rotas principais**: `apps/platform/src/app/app.routes.ts`
- **Rotas de auth**: `apps/platform/src/app/auth/auth.routes.ts`
- **ServiÃ§o de auth**: `libs/data-access/src/lib/auth/auth.service.ts`
- **Modelos**: `libs/data-access/src/lib/auth/auth.models.ts`
- **Endpoints**: `libs/data-access/src/lib/auth/auth.api.ts`
- **Main**: `apps/platform/src/main.ts`
- **Environments**: `apps/platform/src/environments/`

## ğŸš€ Comandos Ãšteis

```bash
# Desenvolvimento
nx serve platform

# Build
nx build platform

# Testes
nx test
nx test --code-coverage

# Graph de dependÃªncias
nx graph
```

## ğŸ“š ReferÃªncias RÃ¡pidas

### Modelos de Request/Response
- `LoginRequest`: `{ email: string, password: string, rememberMe?: boolean }`
- `RegisterRequest`: `{ fullName: string, email: string, password: string, acceptTerms: boolean }`
- `RequestMagicLinkRequest`: `{ email: string, redirectUrl?: string, locale?: string }`
- `RefreshRequest`: `{ refreshToken: string }`
- `LoginResponse` / `RegisterResponse`: `AuthSession`
- `AuthSession`: `{ user: AuthUserProfile, tokens: AuthTokens }`
- `AuthTokens`: `{ accessToken, refreshToken, expiresIn, tokenType }`
- `AuthUserProfile`: `{ id, email, fullName, avatarUrl? }`

### Chaves de TraduÃ§Ã£o Comuns
- `auth.validation.required`
- `auth.validation.email`
- `auth.validation.passwordLength`
- `auth.validation.fullName`
- `auth.validation.acceptTerms`

## ğŸ¯ Status Atual

- âœ… Rotas de autenticaÃ§Ã£o implementadas
- âœ… AuthService completo com testes
- âœ… Schemas Zod criados
- âœ… Layouts implementados
- ğŸš§ FormulÃ¡rios reativos pendentes (prÃ³ximo incremento)
- ğŸš§ Guardas de rota pendentes
- ğŸš§ Interceptors HTTP pendentes
- ğŸš§ Signal Store para sessÃ£o pendente

## ğŸ’¡ Dicas para Agentes

1. **Sempre verifique** se um componente Ã© standalone antes de criar
2. **Sempre use** AuthService para operaÃ§Ãµes de autenticaÃ§Ã£o
3. **Sempre valide** com Zod antes de enviar dados
4. **Sempre use** lazy loading para novas rotas
5. **Sempre trate** erros com catchError
6. **Sempre use** chaves de traduÃ§Ã£o para mensagens
7. **Sempre coloque** serviÃ§os compartilhados em `libs/data-access`
8. **Sempre siga** os padrÃµes de nomenclatura estabelecidos

---

**Ãšltima atualizaÃ§Ã£o**: Baseado na estrutura atual do projeto VectorSeek Frontend

